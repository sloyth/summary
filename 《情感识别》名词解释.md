论文为《基于深度学习的多模态情感识别_张雪》

### 情感识别技术

是使计算机在接受各种信号的过程中，能够精准的识别出人类不同的情感状态和相关信息

### 文本情感分析的三个方向

基于情感词典的情感分析方法、基于机器学习的情感分析方法、基于深度学习的情感分析方法

### *基于加权矩阵的算法

能够利用多模态信息进行面部的情感识别

Facial emotion recognition using multi-modal  information[^1]

### 学习子空间模式识别法

一种基于模式识别的面部表情情感识别方法，这种方法能够利用样本对子空间进行修正，能最大限度地利用样本集优化子空间

### 基于boosting的双模态融合方法

针对实际情况将决策层融合和特征层融合的优点有效结合起来[^2]

#### Boosting

集成学习（boosting）是通过训练弱干个弱学习器，并通过一定的结合策略，从而形成一个强学习器。[相关链接](https://www.biaodianfu.com/boosting.html)

### 基于改进蚁群算法的多模态情感识别方法

在图像分析的基础上融合生理信号，通过蚁群算法按照规范性的原则和要求合理的进行特征选择，找到一个最适合的情感识别算法，进而能够迅速高效地获取问题的最优解[^3]

#### 蚁群算法

蚁群算法（Ant Clony Optimization， ACO）是一种群智能算法，它是由一群无智能或有轻微智能的个体（Agent）通过相互协作而表现出智能行为，从而为求解复杂问题提供了一个新的可能性[相关链接](https://zhuanlan.zhihu.com/p/137408401)

### IEMOCAP情感数据库

交互式情绪并动捕捉（IEMOCAP）数据库包含10位演员的约12小时的试听数据，包括视频、语音、面部动作捕捉、文本转录。其中每句话都由 3-4 名评估员进行评估。评估表包含 10 个选项(中性、快乐、悲伤、厌恶、惊讶、兴奋、愤怒、沮丧、恐惧、其他)

### *马尔可夫链

马尔可夫链（Markov Chain, MC）是概率论和数理统计中具有马尔可夫性质（Markov property）且存在于离散的指数集（index set）和状态空间（state space）内的随机过程（stochastic process）[相关链接](https://baike.baidu.com/item/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E9%93%BE/6171383?fr=aladdin)

### *CTC（connectionist temporal classification)损失函数

联结性时序分类？

[简介](https://www.cnblogs.com/liaohuiqiang/p/9953978.html)

### *梅尔频率倒谱系数(Mel Frequency Cepstrum Coefficient, *MFCC*)

[相关链接](https://blog.csdn.net/fengzhonghen/article/details/51722555)

### *3D-CNN,text-CNN,openSMILE

论文中提到的目前IEMOCAP上的最新研究方案

### IEMOCAP 情感数据库预处理

对于语音数据，本文先进行预加重、分帧加窗等处理。再基于MFCC进行特征提取。

对于视频数据，本文取脸部图像，头部运动捕捉和手部运动捕捉，对开始和结束时间值之间的所有特征值进行采样

对于每个对话的对应文本，我们使用预先训练好的 300 维的GloVe去训练词向量。 

#### 语音情感信号预处理

采用预加重来平滑语音频谱，再进行分帧、加窗等一系列操作改善语音信号的质量

##### 窗函数

为了减少频谱能量泄漏，可采用不同的截取函数对信号进行截断，截断函数称为窗函数，简称为窗。窗函数就是时域有限宽的信号。常用的窗函数有三种，分别是矩形窗、汉明窗、海宁窗

[额外链接](https://zhuanlan.zhihu.com/p/24318554)

##### 双门限法的端点检测技术

端点检测就是将音频中浊音部分与清音部分区分出来。其准确度会直接影响语音情感识别系统最终的准确率。同时，端点检测能够极大程度地降低系统的计算量以及数据信息量，提高系统的运行效率。

其中，最广泛应用的是双门限法的端点检测方法。

“双门限法主要利用了语音的短时能量与短时过零率特征进行综合性分析，这两个因素的主要原因是浊音的能量高于清音，清音的过零率高于无声部分。这样的话，我们就可以先利用能量，将浊音部分区分出来，再利用过零率，将清音也提取出来，就完成了端点检测。”

这部分内容在论文中有讲解

[端点检测](https://blog.csdn.net/zachmm/article/details/41825023)

#### 视频信号预处理

基于视频人脸表情的情感识别中涉及到两个重要的方向：**基于序列视频图像序列动态变化的动态特征情感识别**和**基于图像本身形态变化的静态特征情感识别**。前者关注的是视频中人脸表情的<u>运动信息变化</u>，后者则通过选取视频中有效的<u>人脸表情图像关键帧</u>进行情感识别。

本文中对视频进行隔一段时间的取帧，然后系统地分析这些帧。

#### 基于GloVe的词向量提取

在进行文本情感识别前我们要做的最初的工作是对文本进行预处理，之后进行特征提取

预处理主要包括分词、标注词性、分析语法语义等

特征提取是在预处理完成之后对文章中有情感倾向的句子词语进行标注并将其转化为情感特征。

##### 全局词向量 GloVe（Global Vectors for Word Representation）

全局词向量可以进行词的向量化表示，使输出的词向量之间蕴含更多的语义和语法信息。

主要过程为首先基于某一语料库来构建词的共现矩阵，然后基于共现矩阵和GloVe 模型学习词向量。[共现矩阵](https://blog.csdn.net/qq_35290785/article/details/98231826)

**具体方法在论文中**

### 多模态信息融合方式

常用的特征融合算法主要包括：基于数据层融合算法、基于决策层融合算法和基于特征层融合算法。 

#### 数据层融合算法

将各个模态的数据信息，采用专业性的方式融合在一起，在此基础上能够有效形成一个总的输入，接着把此输入利用神经网络精准的提取特征，再进行分类。但该方法关于如何将不同模态的输入信号信息有效融合仍然是难点，而且输入信号本身存在数据分布不均匀的问题，故本文未采用。![image-20210114160320716](C:\Users\sloyth\AppData\Roaming\Typora\typora-user-images\image-20210114160320716.png)

#### 决策层融合算法

首先将不同模态先分别进行单模态情感识别，再将不同模态单独识别的数据信息结果综合性融合，通常情况下，使用求和的方式或者是投票的方式进行分析处理的。这种决策层融合方式在极大程度上会受单个模态的信息数据结果的影响，容错率较低。

![image-20210114160431883](C:\Users\sloyth\AppData\Roaming\Typora\typora-user-images\image-20210114160431883.png)

#### 特征层融合算法

将提取出来的不同模态的特征统一起来直接连接成一个特征向量，然后再通过分类识别算法进行后续的情感识别。该融合算法提供了一种较为简单易于实现的方法来进行特征融合，也比较完整地将不同模态的特征向量结合在一起进行情感识别，实现了信息的统一实现。故本文使用此方法。![image-20210114160615438](C:\Users\sloyth\AppData\Roaming\Typora\typora-user-images\image-20210114160615438.png)

### 基于深度学习的多模态情感特征提取

#### 长短期记忆网络（LSTM，Long Short-Term Memory）

一种时间循环神经网络，是为了解决一般的RNN存在的长期依赖问题而专门设计出来的。适合于处理和预测时间序列中间隔和延迟非常长的重要事件。

LSTM的重复网络模块主要能够实现遗忘门、输入门、输出门三个门计算。

**遗忘门**主要的作用是决定保留多少上一时刻的单元状态至当前时刻的单元状态。针对实际情况分析与计算，采用sigmoid对信息进行专业的处理，1代表全部保留，0代表全部忘记。

**输入门**用来有效决定保留多少当前时刻的输入至当前时刻的具体的单元状态。通过分析与计算决定哪些是具有价值的信息资源，采取信息化方式有效存储于状态单元中。根据两个部分建立一个新的记忆（公式略）。

当前时刻的单元状态通过遗忘门输入以及上一时刻状态进行乘积，同时加上输入门两部分的乘积（公式略）。

**输出门**主要的任务是针对实际情况决定当前时刻的单元状态涉及到多少输出。通过sigmoid函数综合分析和计算应当输出哪些有价值的信息，在此基础上与当前单元状态相乘，利用tanh函数的值进行输出

每个LSTM包含三个输入，即上时刻的单元状态、上时刻LSTM的输出、当前时刻输入。

#### CNN算法模型

##### 卷积层

卷积层是CNN的核心组件，利用多个卷积核对输入的图像进行卷积滤波来提取图像的不同角度特征，并将卷积输出为特征图。

##### 池化层

经过卷积层提取到的特征一般都会有冗余，所以通过池化层对卷积输出的特征图采取专业技术方式进行下采样，合并冗余，提取更有效的特征，同时也起到降低维度，减少计算量，进一步防止过拟合。

池化层一般包含平均池化与最大池化。**平均池化**是指卷积层输出的特征图中每个池的平均值，映射到池化输出的一个像素单元。**最大池化**是指卷积层输出的特征图中每个池的最大值，映射到池化输出的一个像素单元。

##### 全连接层

可以将卷积核池化的作用看作是提取特征，而全连接层起到决策分类器的作用。在训练的过程中需要以一定的概率使一部分神经元失活从而降低过拟合。

##### AlexNet

AlexNet 是采用 8 层的卷积神经网络，5 个卷积池化组和 3 个全连接层。AlexNet 采用了 ReLU  激活函数，这个函数在训练时间梯度衰减方面比非线性饱和函数如sigmoid或者tanh函数要快
实验表明ReLU收敛的速度比tanh快 6 倍。同时，使用重叠池化比传统池化结果要更好，还可以减轻过拟合的效果。

##### VGGNet

VGGNet从AlexNet发展而来，拥有更深的网络结构，同时将AlexNet中较大的卷积核替换成了连续的几个3X3的卷积核。这样的结构能够提取处更深度的特征。其次，多卷积核组合的参数比单卷积层的参数更少。缺点在于进行反向传播时中间过多卷积层会增加更多的内存损耗。

##### ResNet

ResNet(Residual  Neural  Network) 通过使用 ResNet 残差单元成功训练出 152 层的深度神经网络，同时参数量相比 VGGNet 低很多。ResNet网络结构可以加速神经网络的训练，模型的准确率也有很大提升，其推广性也很好。这得益于在网络增加了直连通道，允许原始输入信息直接传到后面层中。所以ResNet也称为残差网络，可以解决梯度爆炸或梯度消失的问题，简化了训练的难度。

##### Inception Net

其最大的特点是严格控制了计算量和参数量，其参数量远远小于VGGNet。它借鉴了Network In Network使用了[全局平均池化](https://blog.csdn.net/u012911202/article/details/87099559)代替了全连接层。V2在V1的基础上学习了VGGNet，使用了3X3的卷积核，另外还使用了[BN层](https://blog.csdn.net/qq_38900441/article/details/106047525)（批量归一化 Batch Normalization）。BN 层是一个有效的
正则化方法，能够让大型的卷积神经网络的训练速度得到提升的同时也能将识别率提高。

#### DenseNet提取视频情感特征

DenseNet是一种密集连接并结合[现代化技术方式]提取图像特征，通过这种信息技术手段，能够有效脱离加深网络层数(ResNet)与加宽网络结构(Inception)，在整体实践中来有利于网络性能定式思维的显著升。

采用了特征重用与旁路(Bypass)设置的应用方式，能够在极大程度上有效降低网络中的参数量,同时将梯度消失问题结合实际情况有效解决。 

DenseNet 包含多个 DenseBlock 模块，其中  DenseBlock 由BN+ReLU+Conv(1×1)+BN+ReLU  +Conv(3×3) 组成，DenseBlock之间的层称transition  layer 由 BN+Conv(1×1)+Average  Pooling(2×2)组成。

![image-20210114181815139](C:\Users\sloyth\AppData\Roaming\Typora\typora-user-images\image-20210114181815139.png)

transition  layer 模块中加入了 1×1 的卷积（bottleneck layer）做降维，可以提升计算效率。

在  DenseNet 网络中，任意两层之间都有着密不可分的联系，也就是说网络中任意一个下一层的输入实际上都对应的是前面全部层输出结果的叠加，而该层所得到的结果也将和之前的输出作为输入传输给下一层，这样依次向下传输。这种密集连接不会带来冗余，每层网络计算的减少以及特征的重复利用使得  DenseNet 比其他网络效率更高。该方式能进一步提高模型的容量和参数利用率，在准确率上也比传统的残差网络(ResNet)要高。 

总体来说  DenseNet  可以在一定程度上解决梯度消失问题，加强特征传播，更有效地利用特征，同时可以减少参数数量。

[额外链接](https://zhuanlan.zhihu.com/p/37189203)

#### Adam优化算法

Adam 优化算法是能够有效代替传统随机梯度下降（SGD）过程算法的一阶优化算法。

SGD 保持单一的学习率（即  alpha）更新其中的所有权重，学习率在整个训练时不会发生任何的改变。而 Adam 采用计算梯度的一阶和二阶矩估计为各个参数专门设计独立的自适应性学习率且发挥其实质性的作用。

具体公式计算论文中有提

### 结合注意力机制的特征层融合方式

注意力机制（Attention 模型）在语音识别、图像识别和自然语言处理三大深度学习的热门领域均有广泛的使用。Attention 模型模仿人看图像时，目光的焦点在不同的物体上移动。

最直观衡量特征重要性的方法就是权重，因此，Attention 模型的结果就是在每次识别时，首先计算每个特征的权值，然后对特征进行加权求和，权值越大，该特征对当前识别的贡献就大。

目前应用的最广泛的注意力机制的模型是 [Encoder-Decoder 框架](https://blog.csdn.net/qq_38906523/article/details/79838000)

在应用过程中先对一个权重矩阵按照规范性的方式进行初始化，对应的是各个模态特征的权重值，接着在特征融合层进行模态特征融合的综合性应用过程中，将各个模态的权重值与所对应的特征向量进行相乘，在此基础上做级联操作，最后进行分类输出。

此权重矩阵的值在训练过程中有不断的调整，最终能够起到优化识别率的效果。

---

[^1]:L  C De Silva, T Miyasato and  R Nakatsu, "Facial emotion recognition using multi-modal  information,"  Proceedings  of  ICICS,  1997  International Conference on Information, Communications and Signal Processing. Theme: Trends  in  Information  Systems  Engineering  and  Wireless  Multimedia Communications, 1997, pp. 397-401. L  C De Silva, T Miyasato and  R Nakatsu，“基于多模态信息的面部表情识别”，国际信息与通信安全会议(ICICS)会议记录，1997年。主题:资讯系统工程与无线多媒体通讯之趋势，1997，第397-401页。
[^2]:黄力行.  自适应权重的双模态情感识别[C]. 2007:287-291.
[^3]: 解迎刚.  基于改进蚁群算法的多模态情感识别研究[C]. 2011:144-148.